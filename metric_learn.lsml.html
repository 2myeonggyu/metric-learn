

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Least Squares Metric Learning (LSML) &mdash; metric-learn 0.4.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="metric-learn 0.4.0 documentation" href="index.html"/>
        <link rel="next" title="Sparse Determinant Metric Learning (SDML)" href="metric_learn.sdml.html"/>
        <link rel="prev" title="Information Theoretic Metric Learning (ITML)" href="metric_learn.itml.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> metric-learn
          

          
          </a>

          
            
            
              <div class="version">
                0.4.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="metric_learn.covariance.html">Covariance metric (baseline method)</a></li>
<li class="toctree-l1"><a class="reference internal" href="metric_learn.lmnn.html">Large Margin Nearest Neighbor (LMNN)</a></li>
<li class="toctree-l1"><a class="reference internal" href="metric_learn.nca.html">Neighborhood Components Analysis (NCA)</a></li>
<li class="toctree-l1"><a class="reference internal" href="metric_learn.lfda.html">Local Fisher Discriminant Analysis (LFDA)</a></li>
<li class="toctree-l1"><a class="reference internal" href="metric_learn.mlkr.html">Metric Learning for Kernel Regression (MLKR)</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="metric_learn.itml.html">Information Theoretic Metric Learning (ITML)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Least Squares Metric Learning (LSML)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#example-code">Example Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="metric_learn.sdml.html">Sparse Determinant Metric Learning (SDML)</a></li>
<li class="toctree-l1"><a class="reference internal" href="metric_learn.rca.html">Relative Components Analysis (RCA)</a></li>
<li class="toctree-l1"><a class="reference internal" href="metric_learn.mmc.html">Mahalanobis Metric Learning for Clustering (MMC)</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="metric_learn.html">Package Overview</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="metric_learn.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="metric_learn.base_metric.html">metric_learn.base_metric module</a></li>
<li class="toctree-l3"><a class="reference internal" href="metric_learn.itml.html">Information Theoretic Metric Learning (ITML)</a></li>
<li class="toctree-l3"><a class="reference internal" href="metric_learn.lfda.html">Local Fisher Discriminant Analysis (LFDA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="metric_learn.lmnn.html">Large Margin Nearest Neighbor (LMNN)</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Least Squares Metric Learning (LSML)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example-code">Example Code</a></li>
<li class="toctree-l4"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="metric_learn.mlkr.html">Metric Learning for Kernel Regression (MLKR)</a></li>
<li class="toctree-l3"><a class="reference internal" href="metric_learn.mmc.html">Mahalanobis Metric Learning for Clustering (MMC)</a></li>
<li class="toctree-l3"><a class="reference internal" href="metric_learn.nca.html">Neighborhood Components Analysis (NCA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="metric_learn.rca.html">Relative Components Analysis (RCA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="metric_learn.sdml.html">Sparse Determinant Metric Learning (SDML)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="metric_learn.html#module-metric_learn">Module contents</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">metric-learn</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Least Squares Metric Learning (LSML)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/metric_learn.lsml.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-metric_learn.lsml">
<span id="least-squares-metric-learning-lsml"></span><h1>Least Squares Metric Learning (LSML)<a class="headerlink" href="#module-metric_learn.lsml" title="Permalink to this headline">¶</a></h1>
<p>Liu et al.
“Metric Learning from Relative Comparisons by Minimizing Squared Residual”.
ICDM 2012.</p>
<p>Adapted from <a class="reference external" href="https://gist.github.com/kcarnold/5439917">https://gist.github.com/kcarnold/5439917</a>
Paper: <a class="reference external" href="http://www.cs.ucla.edu/~weiwang/paper/ICDM12.pdf">http://www.cs.ucla.edu/~weiwang/paper/ICDM12.pdf</a></p>
<dl class="class">
<dt id="metric_learn.lsml.LSML">
<em class="property">class </em><code class="descclassname">metric_learn.lsml.</code><code class="descname">LSML</code><span class="sig-paren">(</span><em>tol=0.001</em>, <em>max_iter=1000</em>, <em>prior=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/metric_learn/lsml.html#LSML"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#metric_learn.lsml.LSML" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="metric_learn.base_metric.html#metric_learn.base_metric.BaseMetricLearner" title="metric_learn.base_metric.BaseMetricLearner"><code class="xref py py-class docutils literal notranslate"><span class="pre">metric_learn.base_metric.BaseMetricLearner</span></code></a></p>
<dl class="method">
<dt id="metric_learn.lsml.LSML.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>tol=0.001</em>, <em>max_iter=1000</em>, <em>prior=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/metric_learn/lsml.html#LSML.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#metric_learn.lsml.LSML.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize LSML.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>tol</strong> : float, optional</p>
<p><strong>max_iter</strong> : int, optional</p>
<p><strong>prior</strong> : (d x d) matrix, optional</p>
<blockquote>
<div><p>guess at a metric [default: inv(covariance(X))]</p>
</div></blockquote>
<p><strong>verbose</strong> : bool, optional</p>
<blockquote class="last">
<div><p>if True, prints information while learning</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="metric_learn.lsml.LSML.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>X</em>, <em>constraints</em>, <em>weights=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/metric_learn/lsml.html#LSML.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#metric_learn.lsml.LSML.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Learn the LSML model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>X</strong> : (n x d) data matrix</p>
<blockquote>
<div><p>each row corresponds to a single instance</p>
</div></blockquote>
<p><strong>constraints</strong> : 4-tuple of arrays</p>
<blockquote>
<div><p>(a,b,c,d) indices into X, such that d(X[a],X[b]) &lt; d(X[c],X[d])</p>
</div></blockquote>
<p><strong>weights</strong> : (m,) array of floats, optional</p>
<blockquote class="last">
<div><p>scale factor for each constraint</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="metric_learn.lsml.LSML.fit_transform">
<code class="descname">fit_transform</code><span class="sig-paren">(</span><em>X</em>, <em>y=None</em>, <em>**fit_params</em><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.lsml.LSML.fit_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit to data, then transform it.</p>
<p>Fits transformer to X and y with optional parameters fit_params
and returns a transformed version of X.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>X</strong> : numpy array of shape [n_samples, n_features]</p>
<blockquote>
<div><p>Training set.</p>
</div></blockquote>
<p><strong>y</strong> : numpy array of shape [n_samples]</p>
<blockquote>
<div><p>Target values.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>X_new</strong> : numpy array of shape [n_samples, n_features_new]</p>
<blockquote class="last">
<div><p>Transformed array.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="metric_learn.lsml.LSML.get_params">
<code class="descname">get_params</code><span class="sig-paren">(</span><em>deep=True</em><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.lsml.LSML.get_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Get parameters for this estimator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>deep</strong> : boolean, optional</p>
<blockquote>
<div><p>If True, will return the parameters for this estimator and
contained subobjects that are estimators.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>params</strong> : mapping of string to any</p>
<blockquote class="last">
<div><p>Parameter names mapped to their values.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="metric_learn.lsml.LSML.metric">
<code class="descname">metric</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/metric_learn/lsml.html#LSML.metric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#metric_learn.lsml.LSML.metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Mahalanobis matrix from the transformation matrix.</p>
<div class="math notranslate nohighlight">
\[M = L^{\top} L\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>M</strong> : (d x d) matrix</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="metric_learn.lsml.LSML.set_params">
<code class="descname">set_params</code><span class="sig-paren">(</span><em>**params</em><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.lsml.LSML.set_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<p>The method works on simple estimators as well as on nested objects
(such as pipelines). The latter have parameters of the form
<code class="docutils literal notranslate"><span class="pre">&lt;component&gt;__&lt;parameter&gt;</span></code> so that it’s possible to update each
component of a nested object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">self</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="metric_learn.lsml.LSML.transform">
<code class="descname">transform</code><span class="sig-paren">(</span><em>X=None</em><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.lsml.LSML.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the metric transformation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>X</strong> : (n x d) matrix, optional</p>
<blockquote>
<div><p>Data to transform. If not supplied, the training data will be used.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>transformed</strong> : (n x d) matrix</p>
<blockquote class="last">
<div><p>Input data transformed to the metric space by <span class="math notranslate nohighlight">\(XL^{\top}\)</span></p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="metric_learn.lsml.LSML.transformer">
<code class="descname">transformer</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.lsml.LSML.transformer" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the transformation matrix from the Mahalanobis matrix.</p>
<p>L = cholesky(M).T</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>L</strong> : upper triangular (d x d) matrix</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="metric_learn.lsml.LSML_Supervised">
<em class="property">class </em><code class="descclassname">metric_learn.lsml.</code><code class="descname">LSML_Supervised</code><span class="sig-paren">(</span><em>tol=0.001</em>, <em>max_iter=1000</em>, <em>prior=None</em>, <em>num_labeled=inf</em>, <em>num_constraints=None</em>, <em>weights=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/metric_learn/lsml.html#LSML_Supervised"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#metric_learn.lsml.LSML_Supervised" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#metric_learn.lsml.LSML" title="metric_learn.lsml.LSML"><code class="xref py py-class docutils literal notranslate"><span class="pre">metric_learn.lsml.LSML</span></code></a></p>
<dl class="method">
<dt id="metric_learn.lsml.LSML_Supervised.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>tol=0.001</em>, <em>max_iter=1000</em>, <em>prior=None</em>, <em>num_labeled=inf</em>, <em>num_constraints=None</em>, <em>weights=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/metric_learn/lsml.html#LSML_Supervised.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#metric_learn.lsml.LSML_Supervised.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the supervised version of <cite>LSML</cite>.</p>
<p><cite>LSML_Supervised</cite> creates quadruplets from labeled samples by taking two
samples from the same class, and two samples from different classes.
This way it builds quadruplets where the two first points must be more
similar than the two last points.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>tol</strong> : float, optional</p>
<p><strong>max_iter</strong> : int, optional</p>
<p><strong>prior</strong> : (d x d) matrix, optional</p>
<blockquote>
<div><p>guess at a metric [default: covariance(X)]</p>
</div></blockquote>
<p><strong>num_labeled</strong> : int, optional (default=np.inf)</p>
<blockquote>
<div><p>number of labeled points to keep for building quadruplets. Extra
labeled points will be considered unlabeled, and ignored as such.
Use np.inf (default) to use all labeled points.</p>
</div></blockquote>
<p><strong>num_constraints: int, optional</strong></p>
<blockquote>
<div><p>number of constraints to generate</p>
</div></blockquote>
<p><strong>weights</strong> : (m,) array of floats, optional</p>
<blockquote>
<div><p>scale factor for each constraint</p>
</div></blockquote>
<p><strong>verbose</strong> : bool, optional</p>
<blockquote class="last">
<div><p>if True, prints information while learning</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="metric_learn.lsml.LSML_Supervised.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>X</em>, <em>y</em>, <em>random_state=&lt;module 'numpy.random' from '/home/will/anaconda3/envs/sklearn-dev/lib/python3.6/site-packages/numpy/random/__init__.py'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/metric_learn/lsml.html#LSML_Supervised.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#metric_learn.lsml.LSML_Supervised.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Create constraints from labels and learn the LSML model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>X</strong> : (n x d) matrix</p>
<blockquote>
<div><p>Input data, where each row corresponds to a single instance.</p>
</div></blockquote>
<p><strong>y</strong> : (n) array-like</p>
<blockquote>
<div><p>Data labels.</p>
</div></blockquote>
<p><strong>random_state</strong> : numpy.random.RandomState, optional</p>
<blockquote class="last">
<div><p>If provided, controls random number generation.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="metric_learn.lsml.LSML_Supervised.fit_transform">
<code class="descname">fit_transform</code><span class="sig-paren">(</span><em>X</em>, <em>y=None</em>, <em>**fit_params</em><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.lsml.LSML_Supervised.fit_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit to data, then transform it.</p>
<p>Fits transformer to X and y with optional parameters fit_params
and returns a transformed version of X.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>X</strong> : numpy array of shape [n_samples, n_features]</p>
<blockquote>
<div><p>Training set.</p>
</div></blockquote>
<p><strong>y</strong> : numpy array of shape [n_samples]</p>
<blockquote>
<div><p>Target values.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>X_new</strong> : numpy array of shape [n_samples, n_features_new]</p>
<blockquote class="last">
<div><p>Transformed array.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="metric_learn.lsml.LSML_Supervised.get_params">
<code class="descname">get_params</code><span class="sig-paren">(</span><em>deep=True</em><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.lsml.LSML_Supervised.get_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Get parameters for this estimator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>deep</strong> : boolean, optional</p>
<blockquote>
<div><p>If True, will return the parameters for this estimator and
contained subobjects that are estimators.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>params</strong> : mapping of string to any</p>
<blockquote class="last">
<div><p>Parameter names mapped to their values.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="metric_learn.lsml.LSML_Supervised.metric">
<code class="descname">metric</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.lsml.LSML_Supervised.metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Mahalanobis matrix from the transformation matrix.</p>
<div class="math notranslate nohighlight">
\[M = L^{\top} L\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>M</strong> : (d x d) matrix</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="metric_learn.lsml.LSML_Supervised.set_params">
<code class="descname">set_params</code><span class="sig-paren">(</span><em>**params</em><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.lsml.LSML_Supervised.set_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<p>The method works on simple estimators as well as on nested objects
(such as pipelines). The latter have parameters of the form
<code class="docutils literal notranslate"><span class="pre">&lt;component&gt;__&lt;parameter&gt;</span></code> so that it’s possible to update each
component of a nested object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">self</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="metric_learn.lsml.LSML_Supervised.transform">
<code class="descname">transform</code><span class="sig-paren">(</span><em>X=None</em><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.lsml.LSML_Supervised.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the metric transformation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>X</strong> : (n x d) matrix, optional</p>
<blockquote>
<div><p>Data to transform. If not supplied, the training data will be used.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>transformed</strong> : (n x d) matrix</p>
<blockquote class="last">
<div><p>Input data transformed to the metric space by <span class="math notranslate nohighlight">\(XL^{\top}\)</span></p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="metric_learn.lsml.LSML_Supervised.transformer">
<code class="descname">transformer</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.lsml.LSML_Supervised.transformer" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the transformation matrix from the Mahalanobis matrix.</p>
<p>L = cholesky(M).T</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>L</strong> : upper triangular (d x d) matrix</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<div class="section" id="example-code">
<h2>Example Code<a class="headerlink" href="#example-code" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">metric_learn</span> <span class="k">import</span> <span class="n">LSML_Supervised</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="k">import</span> <span class="n">load_iris</span>

<span class="n">iris_data</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">iris_data</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">iris_data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>

<span class="n">lsml</span> <span class="o">=</span> <span class="n">LSML_Supervised</span><span class="p">(</span><span class="n">num_constraints</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">lsml</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="metric_learn.sdml.html" class="btn btn-neutral float-right" title="Sparse Determinant Metric Learning (SDML)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="metric_learn.itml.html" class="btn btn-neutral" title="Information Theoretic Metric Learning (ITML)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2018, CJ Carey and Yuan Tang.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.4.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>